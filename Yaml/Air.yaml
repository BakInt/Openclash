# ================================================
# OpenClash ä¼˜åŒ–é…ç½®æ¨¡æ¿ --BakInt
#
# ğŸ‰ æ¬¢è¿ä½¿ç”¨ BakInt æ•´ç†çš„ OpenClash é…ç½®æ¨¡æ¿ï¼
# ğŸ“Œ ä½œè€…ï¼šBakInt
#
# ğŸ¤ ç‰¹åˆ«æ„Ÿè°¢ï¼š
#   - MetaCubeX å›¢é˜Ÿæä¾›çš„ä¼˜ç§€è§„åˆ™é›†
#   - blackmatrix7 çš„ iOS Rule Script é¡¹ç›®
#   - liandu2024 çš„ clash é…ç½®åˆ†äº«
#   - ä»¥åŠå…¶ä»–ä¸ºå¼€æºç¤¾åŒºè´¡çŒ®çš„å¤§ä½¬ä»¬
#
# ğŸ“Œ ä½¿ç”¨æç¤ºï¼š
#   1. è¯·è‡ªè¡Œæ·»åŠ æ‚¨çš„æœºåœºè®¢é˜…é“¾æ¥
#   2. å¯æ ¹æ®éœ€è¦è°ƒæ•´ç­–ç•¥ç»„é…ç½®
#   3. å»ºè®®å®šæœŸæ›´æ–°è§„åˆ™é›†ä»¥è·å¾—æœ€ä½³ä½“éªŒ
# âš ï¸ æ³¨æ„ï¼šåˆ†äº«æ—¶è¯·å‹¿åŒ…å«ä¸ªäººè®¢é˜…ä¿¡æ¯
#
# ğŸ“ è¯´æ˜ï¼šæ­¤é…ç½®åŸºäºä¸ªäººä½¿ç”¨ç»éªŒæ•´ç†ï¼Œä»…ä¾›å‚è€ƒ
# ================================================

# æœºåœºèŠ‚ç‚¹è®¢é˜…é…ç½®ç¤ºä¾‹ï¼ˆè¯·æ›¿æ¢ä¸ºæ‚¨çš„å®é™…è®¢é˜…é“¾æ¥ï¼‰
proxy-providers:
  # ç¤ºä¾‹é…ç½® - è¯·æ›¿æ¢ä¸ºæ‚¨çš„å®é™…è®¢é˜…
  # è®¢é˜…1:
  #   url: "æ‚¨çš„è®¢é˜…é“¾æ¥1"
  #   type: http
  #   interval: 86400
  #   health-check:
  #     enable: true
  #     url: https://www.gstatic.com/generate_204
  #     interval: 180
  #   proxy: ç›´è¿

  # è®¢é˜…2:
  #   url: "æ‚¨çš„è®¢é˜…é“¾æ¥2"
  #   type: http
  #   interval: 86400
  #   health-check:
  #     enable: true
  #     url: https://www.gstatic.com/generate_204
  #     interval: 180
  #   proxy: ç›´è¿

# è‡ªå®šä¹‰èŠ‚ç‚¹ç¤ºä¾‹ï¼ˆå¯æŒ‰éœ€æ·»åŠ ï¼‰
proxies:
  # ç¤ºä¾‹èŠ‚ç‚¹ - è¯·æ›¿æ¢ä¸ºæ‚¨çš„å®é™…èŠ‚ç‚¹ä¿¡æ¯
  # - name: "æˆ‘çš„èŠ‚ç‚¹01"
  #   type: ss
  #   server: "your.server.com"
  #   port: 8388
  #   cipher: "aes-256-gcm"
  #   password: "your-password"
  #   udp: true

  # åŸºç¡€ä»£ç†é€‰é¡¹
  - {name: ç›´è¿, type: direct}
  - {name: æ‹’ç», type: reject}

# ========================
# ä¸»è¦ç«¯å£è®¾ç½®
# ========================
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7895

allow-lan: true
mode: rule
log-level: info

external-controller: 0.0.0.0:9090
secret: "123456"  # âš ï¸ å»ºè®®ä¿®æ”¹ä¸ºå¼ºå¯†ç 

# ========================
# DNS è®¾ç½®
# ========================
dns:
  enable: true
  listen: 0.0.0.0:7874
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.20.0.1/16
  nameserver:
    - 223.5.5.5  # é˜¿é‡ŒDNS
    - 119.29.29.29  # è…¾è®¯DNS
  fake-ip-filter:
    - +.lan
    - +.local
    - geosite:cn

ipv6: false

# ========================
# TUN æ¨¡å—
# ========================
tun:
  enable: true
  stack: gvisor
  device: utun
  endpoint-independent-nat: true
  auto-route: false
  auto-detect-interface: false
  auto-redirect: false
  strict-route: false

profile:
  store-selected: true
  store-fake-ip: true

# ========================
# ç­–ç•¥ç»„å®šä¹‰
# ========================
# ğŸ“ æ¸©é¦¨æç¤ºï¼š
#   - ç­–ç•¥ç»„å¯æŒ‰éœ€è‡ªå®šä¹‰
#   - å»ºè®®æ ¹æ®å®é™…èŠ‚ç‚¹æƒ…å†µè°ƒæ•´
#   - æ™ºèƒ½é€‰æ‹©æ¨¡å¼éœ€è¦è¶³å¤Ÿçš„èŠ‚ç‚¹æ•°é‡

default: &default
  type: select
  proxies:
    - ç›´è¿
    - æ‰€æœ‰-æ‰‹é€‰
    - æ‰€æœ‰-æ™ºé€‰
    - é¦™æ¸¯-æ•…è½¬
    - å°æ¹¾-æ•…è½¬
    - æ—¥æœ¬-æ•…è½¬
    - æ–°åŠ å¡-æ•…è½¬
    - ç¾å›½-æ•…è½¬
    - å…¶ä»–-æ•…è½¬
    - å®¶å®½-æ‰‹é€‰
    - è¶…å€¼é€š-æ™ºé€‰
    - æ‹’ç»

proxy-groups:

  # ä¸šåŠ¡åˆ†æµç»„
  - {name: AI, <<: *default}
  - {name: Streaming, <<: *default}
  - {name: GitHub, <<: *default}
  - {name: Chat, <<: *default}  
  - {name: TikTok, <<: *default}  
  - {name: Google, <<: *default}  
  - {name: Apple, <<: *default}
  - {name: Microsoft, <<: *default}
  - {name: Games, <<: *default}
  - {name: Crypto, <<: *default}
  - {name: Test, <<: *default}
  - {name: Cloudflare, <<: *default}  
  - {name: Other, <<: *default}  

  # æ‰€æœ‰ç»„
  - name: æ‰€æœ‰-æ‰‹é€‰
    type: select
    include-all: true
    filter: "^((?!(ç›´è¿|æ‹’ç»)).)*$"
    
  - name: æ‰€æœ‰-æ™ºé€‰
    type: smart
    include-all: true
    policy-priority: ".*é¦™æ¸¯.*:1.5;.*å°æ¹¾.*:1.5"  # ä¼˜å…ˆé€‰æ‹©æ¸¯å°èŠ‚ç‚¹
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "^((?!(ç›´è¿|æ‹’ç»)).)*$"

  # åœ°åŒºåˆ†ç»„ï¼ˆç¤ºä¾‹ï¼‰
  - name: é¦™æ¸¯-æ•…è½¬
    type: fallback
    interval: 180
    lazy: false
    proxies:
      - é¦™æ¸¯-æ‰‹é€‰
      - é¦™æ¸¯-æ™ºé€‰
  
  - name: é¦™æ¸¯-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°)).*$"
    
  - name: é¦™æ¸¯-æ™ºé€‰
    type: smart
    include-all: true
    uselightgbm: true
    collectdata: true
    health-check: 
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 60
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°)).*$"

  # å…¶ä»–åœ°åŒºçš„ç»„åˆåŒç†é…ç½®...
  # å°æ¹¾ã€æ—¥æœ¬ã€æ–°åŠ å¡ã€ç¾å›½ç­‰

  # ç‰¹è‰²åˆ†ç»„
  - name: å®¶å®½-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å®¶å®½|ä¸­è½¬)).*$"

# ========================
# è§„åˆ™å¼•æ“ï¼ˆrulesï¼‰
# ========================
# ğŸ”¥ è§„åˆ™è¯´æ˜ï¼š
#   - æŒ‰åº”ç”¨åœºæ™¯åˆ†ç±»æ•´ç†
#   - æ”¯æŒ AIã€æµåª’ä½“ã€æ¸¸æˆç­‰
#   - å¯è‡ªå®šä¹‰æ·»åŠ æ–°è§„åˆ™

rules:
  # AI æœåŠ¡
  - RULE-SET,TEST / Domain,Test
  - RULE-SET,GitHub / Domain,GitHub    
  - RULE-SET,ChatGPT / Domain,AI
  - RULE-SET,Claude / Domain,AI
  - RULE-SET,Copilot / Domain,AI
  - RULE-SET,Gemini / Domain,AI
  - RULE-SET,Groq / Domain,AI
  - RULE-SET,Grok / Domain,AI
  - RULE-SET,Meta AI / Domain,AI
  - RULE-SET,Perplexity / Domain,AI
  
  # ä¼ä¸šæœåŠ¡
  - RULE-SET,Microsoft / Domain,Microsoft
  - RULE-SET,Apple / Domain,Apple
  
  # åŠ å¯†è´§å¸
  - RULE-SET,OKX / Domain,Crypto
  - RULE-SET,Bybit / Domain,Crypto
  - RULE-SET,Binance / Domain,Crypto
  
  # ç¤¾äº¤åª’ä½“
  - RULE-SET,TikTok / Domain,TikTok
  - RULE-SET,Twitter / Domain,Chat  
  - RULE-SET,WhatsApp / Domain,Chat  
  - RULE-SET,Facebook / Domain,Chat  
  - RULE-SET,Telegram / Domain,Chat  
  - RULE-SET,Telegram / IP,Chat,no-resolve
  
  # æµåª’ä½“
  - RULE-SET,Netflix / Domain,Streaming
  - RULE-SET,Netflix / IP,Streaming,no-resolve
  - RULE-SET,Disney / Domain,Streaming
  - RULE-SET,Amazon / Domain,Streaming
  - RULE-SET,HBO / Domain,Streaming
  - RULE-SET,Crunchyroll / Domain,Streaming
  - RULE-SET,Popcorn / Domain,Streaming  
  - RULE-SET,Spotify / Domain,Streaming
  - RULE-SET,Youtube / Domain,Streaming
  - RULE-SET,Reddit / Domain,Streaming  
  
  # æ¸¸æˆå¹³å°
  - RULE-SET,Steam / Domain,Games
  - RULE-SET,Epic / Domain,Games
  - RULE-SET,EA / Domain,Games
  - RULE-SET,Blizzard / Domain,Games
  - RULE-SET,UBI / Domain,Games
  - RULE-SET,PlayStation / Domain,Games
  - RULE-SET,Nintend / Domain,Games
  
  # å…¶ä»–
  - RULE-SET,Google / Domain,Google  
  - RULE-SET,Google / IP,Google,no-resolve
  - RULE-SET,Cloudflare / Domain,Cloudflare
  
  # æœ€ç»ˆè§„åˆ™
  - MATCH,Other

# ========================
# è§„åˆ™é›†æä¾›è€…
# ========================
# ğŸ“š è§„åˆ™é›†è¯´æ˜ï¼š
#   - ä½¿ç”¨å®˜æ–¹å’Œç¤¾åŒºç»´æŠ¤çš„è§„åˆ™
#   - å®šæœŸæ›´æ–°ä¿è¯å‡†ç¡®æ€§
#   - å¯æŒ‰éœ€æ·»åŠ è‡ªå®šä¹‰è§„åˆ™

rule-anchor:
  ip: &ip {type: http, interval: 86400, behavior: ipcidr, format: mrs}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: mrs}
  class: &class {type: http, interval: 86400, behavior: classical, format: text}

rule-providers:
  # æµ‹è¯•è§„åˆ™
  TEST / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Check.list"}
  
  # AI æœåŠ¡
  ChatGPT / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/openai.mrs"}
  Claude / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Claude/Claude.list"}
  Meta AI / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/MetaAi.list"}
  Perplexity / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/perplexity.mrs"}
  Copilot / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Copilot.list"}
  Gemini / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Gemini.list"}
  Groq / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/groq.mrs"}
  Grok / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Grok.list"}
  
  # ä¼ä¸šæœåŠ¡
  GitHub / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/github.mrs"}
  Amazon / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/amazon.mrs"}
  Apple / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/apple.mrs"} 
  Microsoft / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/microsoft.mrs"}
  
  # åŠ å¯†è´§å¸
  OKX / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/okx.mrs"}
  Bybit / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/bybit.mrs"}
  Binance / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/binance.mrs"}
  
  # ç¤¾äº¤åª’ä½“
  TikTok / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/tiktok.mrs"}
  Twitter / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/x.mrs"}
  WhatsApp / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/whatsapp.mrs"}
  Facebook / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/facebook.mrs"}
  Telegram / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/telegram.mrs"}  
  Telegram / IP: {<<: *ip, url: "https://gh-proxy.com/github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geoip/telegram.mrs"}
  
  # æµåª’ä½“
  Netflix / Domain: {<<: *domainï¼Œ url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/netflix.mrs"}
  Netflix / IP: {<<: *ip, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geoip/netflix.mrs"}
  Disney / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/disney.mrs"}
  HBO / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/hbo.mrs"}
  Spotify / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/spotify.mrs"}
  Youtube / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/youtube.mrs"}
  Reddit / Domain: {<<: *domain, url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/reddit.mrs"}
  Crunchyroll / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Crunchyroll.list"}
  Popcorn / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Popcorn.list"}
  
  # æ¸¸æˆå¹³å°
  Steam / Domain: {<<: *domainï¼Œ url: "https://gh-proxy.com/github.com/metacubex/meta-rules-dat/raw/refs/heads/meta/geo/geosite/steam.mrs"}
  Epic / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Epic/Epic.list"}
  EA / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/EA/EA.list"}
  Blizzard / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Blizzard/Blizzard.list"}
  UBI / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/UBI/UBI.list"}
  PlayStation / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/PlayStation/PlayStation.list"}
  Nintend / Domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com
